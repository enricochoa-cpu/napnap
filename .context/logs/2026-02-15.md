# 2026-02-15

## Code Audit — Low-Risk and Refactor Applied

Full audit was performed (see plan: code audit and cleanup). The following were applied; decision and optional items were left out of scope.

### Low risk — Removed

- **Unused dependencies (package.json):** Removed Three.js stack (SkyBackground is CSS-only). Removed: `three`, `@react-three/fiber`, `three-bvh-csg`, `@types/three`.
- **Unused hook:** Deleted `src/hooks/useLocalStorage.ts` (never imported).
- **Unused component:** Deleted `src/components/BabyProfile.tsx` (legacy; app uses ProfileSection → MyBabiesView / BabyDetailView).
- **storage.ts:** Removed `removeFromStorage()` (never called). Removed unused `STORAGE_KEYS.BABY_PROFILE` and `STORAGE_KEYS.SLEEP_ENTRIES`; kept `ONBOARDING_DRAFT` and `ACTIVE_BABY_ID`.

### Refactor — DRY and single source of truth

- **SharedBabyProfile:** Consolidated type. ProfileSection and MyBabiesView now import `SharedBabyProfile` from `useBabyProfile`; removed duplicate interface definitions from both files.
- **SleepEntrySheet date helpers:** Replaced local `getNextDay` / `getPreviousDay` (string) with dateUtils: `formatDate(getNextDay(date))` and `formatDate(getPreviousDay(date))`. Added small wrappers `nextDayStr` / `prevDayStr` for readability. Removed duplicate logic.
- **dateUtils.ts:** Removed unused exports: `formatDisplayDate`, `generateId`. Kept `getNextDay` and `getPreviousDay` (now used by SleepEntrySheet).

### Out of scope (not done)

- **AlgorithmStatusCard:** No change (decision: delete component vs re-add status pill).
- **Optional:** Db* types in supabase.ts, useCircadianTheme export, CSS class audit, Sentry config.

### Files touched

- Deleted: `src/hooks/useLocalStorage.ts`, `src/components/BabyProfile.tsx`
- Modified: `package.json`, `src/utils/storage.ts`, `src/utils/dateUtils.ts`, `src/components/SleepEntrySheet.tsx`, `src/components/Profile/ProfileSection.tsx`, `src/components/Profile/MyBabiesView.tsx`
- Updated: `.context/progress.txt`, `.context/MEMORY.md`, `.context/logs/2026-02-15.md`, plan document (tracking)
