# 2026-02-12

## Phase 2: Accessibility (A11Y) — Complete

Full accessibility pass across the entire app. No prior a11y support existed.

### New: `useFocusTrap` Hook
- **File:** `src/hooks/useFocusTrap.ts`
- Traps Tab/Shift+Tab within a container element
- Escape key fires optional `onEscape` callback
- Saves `document.activeElement` on activate, restores on deactivate
- Uses `requestAnimationFrame` for timing (Framer Motion mid-animation safety)
- Returns a `RefObject<HTMLDivElement>` to attach to the dialog container

### Reduced Motion Support
- **App.tsx:** Wrapped root in `<MotionConfig reducedMotion="user">` — all Framer Motion animations respect `prefers-reduced-motion` automatically
- **index.css:** Added `@media (prefers-reduced-motion: reduce)` block — kills all `animation-duration`, `transition-duration`, `scroll-behavior`; cancels star, cloud, loader, spinner animations

### Dialog Semantics on All 9 Modals/Sheets

| Component | Role | aria-label / aria-labelledby |
|-----------|------|------------------------------|
| SleepEntrySheet | `dialog` | `"Edit sleep entry"` / `"Log nap"` / `"Log night sleep"` |
| WakeUpSheet | `dialog` | `"Log wake up time"` |
| QuickActionSheet | `dialog` | `"Quick actions"` |
| BabyEditSheet | `dialog` | `"Add baby"` / `"Edit baby profile"` |
| CalendarModal | `dialog` | `"Calendar"` |
| ConfirmationModal | `alertdialog` | `aria-labelledby` → title element |
| ActivityCollisionModal | `alertdialog` | `aria-labelledby` → title element |
| MissingBedtimeModal | `dialog` | `aria-labelledby` → title element |
| AccountSettingsView (2x) | `alertdialog` | `"Sign out confirmation"` / `"Delete account confirmation"` |

Each dialog received: `ref={dialogRef}` (focus trap), `role`, `aria-modal="true"`, `aria-label` or `aria-labelledby`.

### Backdrop `aria-hidden="true"`
Added to all 7 backdrop `motion.div` overlays to prevent screen readers announcing them as clickable regions.

### `aria-label` Additions
- DayNavigator week strip: 7 day buttons → `format(day, 'EEEE, MMMM d')` (e.g. "Monday, February 10")
- DayNavigator calendar cells → `format(date, 'EEEE, MMMM d, yyyy')`
- DayNavigator date header → `"Open calendar"`
- SleepEntrySheet time inputs → `"Start time"` / `"End time"`
- WakeUpSheet hour/minute inputs → `"Hours"` / `"Minutes"`
- WakeUpSheet colon separator → `aria-hidden="true"`
- SleepEntrySheet dash separator → `aria-hidden="true"`

### Touch Targets (40px → 44px WCAG minimum)
- SleepEntrySheet: Delete + Close buttons `w-10 h-10` → `w-11 h-11`
- WakeUpSheet: Delete + Close buttons `w-10 h-10` → `w-11 h-11`
- DayNavigator: Prev/Next month buttons `w-10 h-10` → `w-11 h-11`
- SubViewHeader: Back button `w-10 h-10` → `w-11 h-11`
- MissingBedtimeModal: Close button → `min-w-[44px] min-h-[44px]`

### Remaining Phases Document
- Created `REMAINING-PHASES.md` in project root with detailed plans for Phase 3 (Light Mode Polish), Phase 4 (UX Improvements), and Phase 5 (Nice-to-Have Refinements)
